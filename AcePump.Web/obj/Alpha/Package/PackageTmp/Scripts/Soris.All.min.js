/*Soris Software (http://www.sorissoftware.com)
Copyright 2015 Soris Software LLC (TM). All rights reserved.

This file is exclusive property of Soris Software.  Your usage is governed by the terms of your "Software Tools" license from Soris Software.  If you do not have a "Software Tools" license from Soris Software, you are not authorized to use this file in any way.*/

/*! Soris 05-05-2016 */

!function(a){"use strict";window.Soris={namespace:function(b){for(var c=b.split("."),d=this,e=0;e<c.length;e++){var f=c[e];d[f]===a&&(d[f]={}),d=d[f]}return d}}}(),function(a,b){"use strict";a.Class=function(){},a.Class.extend=function(a){function b(){}var c=this,d=a;for(var e in c)c.hasOwnProperty(e)&&(d[e]=c[e]);return b.prototype=c.prototype,d.prototype=new b,d.prototype._MyBase=b.prototype,d.prototype.constructor=d,d.prototype.__FirstBaseCtor=c,d.prototype._MyBaseCtor=function(){this._MyBaseCtor=c.prototype._MyBaseCtor,c.apply(this,arguments),this._MyBaseCtor=this.__FirstBaseCtor},d}}(window.Soris),function(a){a.Utility={isUndefined:function(a){return"undefined"==typeof a},argumentRequired:function(b,c){if(a.Utility.isUndefined(b))throw new Error(c+" is a required argument!")},getComparer:function(b){switch(b){case"date":var c=a.Utility.getComparer("int");return function(a,b){return c(a.getTime(),b.getTime())};case"int":return function(a,b){return a===b?0:b>a?-1:1};default:return a.Utility.getComparer("int")}},getParser:function(a){switch(a){case"date":return function(a){return new Date(a)};default:return function(a){return a}}},isDateValid:function(a){var b=/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/,c=a.match(b);if(null===c)return!1;var d=c[2],e=c[1],f=c[3],g=[31,28,31,30,31,30,31,31,30,31,30,31];return(f%400===0||f%100!==0&&f%4===0)&&(g[1]=29),1>d||d>g[e-1]?!1:1>e||e>12?!1:1>f?!1:!0},getQstringParam:function(b){if(a.Utility.isUndefined(window))throw new Error("cannot use getQstringParam outside of a browser window.");if(a.Utility.isUndefined(a.Utility._qstringParams)){var c,d=/([^&=]+)=?([^&]*)/g,e=function(a){return decodeURIComponent(a.replace(/\+/g," "))},f=window.location.search.substring(1);for(qstringParams={};null!==(c=d.exec(f));)qstringParams[e(c[1])]=e(c[2]);a.Utility._qstringParams=qstringParams}return a.Utility._qstringParams[b]},loadDefaults:function(b,c){if(a.Utility.isUndefined(c))return b;for(var d in b)b.hasOwnProperty(d)&&(a.Utility.isUndefined(c[d])?c[d]=b[d]:"object"==typeof b[d]&&a.Utility.loadDefaults(b[d],c[d]));return c},redirect:function(a){window.location=a}}}(window.Soris),function(a,b,c){"use strict";var d=a.namespace("Ui"),e=a.Class.extend(function(){this.UiComponentFactory=new a.Ui.KendoUiComponentFactory,this.p_uiComponentFactory=this.UiComponentFactory});e.prototype.render=function(a){throw new Error("component must implement render!")},d.UiComponentBase=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Ui"),e=a.Class.extend(function(){});e.prototype.RenderSpinner=function(a,b){throw"Provider must implement RenderSpinner"},e.prototype.RenderDatePicker=function(a,b){throw"Provider must implement RenderDatePicker"},e.prototype.RenderEditor=function(a,b){throw"Provider must implement RenderEditor"},e.prototype.RenderDropDown=function(a,b){throw"Provider must implement RenderDropDown"},e.prototype.renderGrid=function(a,b){throw new Error("Provider must impleement RenderGrid")},d.UiComponentFactory=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Ui"),e=d.UiComponentBase.extend(function(){});e.prototype.Clear=function(){throw"Provider must implement Clear"},e.prototype.Add=function(a,b){throw"Provider must implement Add"},d.DropDownList=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Ui"),e=d.UiComponentBase.extend(function(a){this._KendoDropDown=a});e.prototype.Clear=function(){this._KendoDropDownList.dataSource.clear()},e.prototype.Add=function(a,b){this._KendoDropDownList.dataSource.Add({text:a,value:b})},d.KendoDropDownListWrapper=e}(window.Soris,jQuery),function(a){"use strict";var b=a.namespace("Ui"),c=a.Class.extend(function(b){this.options=a.Utility.loadDefaults({},b)});c.prototype.setStaticFilters=function(a){throw new Error("must implement setStaticFilters")},b.GridBase=c}(window.Soris),function(a){"use strict";var b=a.namespace("Ui"),c=b.GridBase.extend(function(a){this._grid=a,this._currentStaticFilters=[]});c.prototype.setStaticFilters=function(b){var c=this._grid.dataSource.filter(),d=a.Utility.isUndefined(c)?[]:c.filters;this._removeStaticFilters(d),this._currentStaticFilters=b,this._addStaticFilters(d),this._grid.dataSource.filter(d)},c.prototype._removeStaticFilters=function(a){for(var b=0;b<this._currentStaticFilters.length;b++)for(var c=this._currentStaticFilters[b],d=0;d<a.length;d++){var e=a[d];if(c.field===e.field){a.splice(d,1);break}}},c.prototype._addStaticFilters=function(a){for(var b=0;b<this._currentStaticFilters.length;b++)a.push(this._currentStaticFilters[b])},b.KendoGridWrapper=c}(window.Soris),function(a,b,c){"use strict";var d=a.namespace("Ui"),e=d.UiComponentFactory.extend(function(){this._MyBaseCtor()});e.prototype.RenderSpinner=function(a,c){return b(a).kendoNumericTextBox(c)},e.prototype.RenderDatePicker=function(a,c){return b(a).kendoDatePicker(c)},e.prototype.RenderEditor=function(a,b){return a},e.prototype.RenderDropDown=function(c,d){return new a.Ui.KendoDropDownListWrapper(b(c).kendoDropDown(d))},e.prototype.renderGrid=function(b,c){return new a.Ui.KendoGridWrapper({grid:b.kendoGrid(c)})},d.KendoUiComponentFactory=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Ui"),e=d.UiComponentBase.extend(function(){});e.prototype._OnSelect=function(a){var c=b.Event("select");c.text=a.text(),c.value=a.val(),b(this).trigger(c),c.isDefaultPrevented()||(this._Title.text(c.text),this._ShowLink())},e.prototype.SelectedValue=function(){return this._Selector.val()},e.prototype.LoadValues=function(a){this._Selector.empty();for(var c=0;c<a.length;c++)this._Selector.append(b("<option>").val(a[c].value).text(a[c].text));a.length>1?this._ShowLink():this._ShowTitleOnly()},e.prototype.Render=function(a){this._Title=b("<span>"),this._Selector=b("<select>").on("change",function(a){var c=b(this).find(":selected"),d=b(this).closest(".s-show-more-container"),e=d.data("sorisShowMore");e._OnSelect(c)}).hide(),this._Link=b("<a>See More</a>").prop("href","#").click(function(a){var c=b(this).closest(".s-show-more-container"),d=c.data("sorisShowMore");d._ShowSelector(),a.preventDefault()}).hide();var c=b("<span>").addClass("s-show-more-container");c.append(this._Title),c.append(this._Selector),c.append(this._Link),c.data("sorisShowMore",this),a.append(c)},e.prototype._ShowSelector=function(){this._Selector.show(),this._Link.hide()},e.prototype._ShowLink=function(){this._Link.show(),this._Selector.hide()},e.prototype._ShowTitleOnly=function(){this._Title.show(),this._Link.hide(),this._Selector.hide()},d.ShowMoreSelector=e}(window.Soris,jQuery),function(a,b){"use strict";b(window).load(function(){a.Kendo.GridHelper.InitializeAllGrids(!0)})}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Kendo"),e=function(a){this._JqObj=a,this._KGrid=a.data("kendoGrid"),this._ColumnCount=null};e.GetHelper=function(a){if(0===a.length)throw"cannot get helper, arg null!";e._LoadGrids();for(var b=0;b<e._Helpers.length;b++)if(e._Helpers[b]._JqObj.is(a))return e._Helpers[b];var c=new e(a);return e._Helpers.push(c),c},e._Helpers=[],e._GridsLoaded=!1,e.InitializeAllGrids=function(a){e._LoadGrids(a);for(var b=0;b<e._Helpers.length;b++){var c=e._Helpers[b];c.Initialize()}},e._LoadGrids=function(a){if(a!==c&&a)e._Helpers=[],e._GridsLoaded=!1;else if(e._GridsLoaded)return;e._GridsLoaded=!0;var d=b("div.k-grid").filter(function(){return b(this).data("kendoGrid")!==c});d.each(function(){e._Helpers.push(new e(b(this)))})},e.GetHelperFromEvent=function(a){var d;if(a.currentTarget!==c)d=b(a.currentTarget).closest(".k-grid");else{if(a.sender===c||a.sender.element===c)throw"Event does not contain reference to a grid, could not get helper!";d=a.sender.element}return e.GetHelper(d)},e.prototype.GetDataItemFromEvent=function(a){var c=b(a.currentTarget).closest("tr"),d=this._KGrid.dataItem(c);return d},e.prototype.Refresh=function(){this._KGrid.dataSource.read(),this._KGrid.refresh()},e.prototype.SaveGrid=function(){this._KGrid.dataSource.sync()},e.prototype.Aggregate=function(a){if("function"!=typeof a)throw"Illegal callback";for(var b=this._KGrid.dataSource.data(),c=0;c<b.length;c++)a(b[c])},e.prototype._GetColumnCount=function(){return null===this._ColumnCount&&(this._ColumnCount=this._KGrid.table.find(".k-grid-header colgroup > col").length),this._ColumnCount},e.prototype.Initialize=function(){this._LoadOptions(),this._CreateFixedHeaderRow(),this._AttachHandlers()},e.prototype._LoadOptions=function(){var a=this._KGrid.element.data("sorisGridOptions");a===c&&(a={}),this._Options={ShowNoRecordsMessage:a.ShowNoRecordsMessage||!1}},e.prototype.Grid=function(){return this._KGrid},e.prototype._GetHasChangesMessageContainer=function(){if(this._HasChangesMessage===c){this._HasChangesMessage=b('<span class="s-grid-change-message" />');var a=this._KGrid.element.find(".k-toolbar");a.length>0&&a.append(this._HasChangesMessage)}return this._HasChangesMessage},e.prototype._ShowHasChangesMessage=function(){this._GetHasChangesMessageContainer().html("There are changes!")},e.prototype._ClearHasChangesMessage=function(){this._GetHasChangesMessageContainer().empty()},e.prototype.DisableEditorFor=function(a,c){var d="[name="+c+"]",e=b(a.container).find(d),f=e.closest("td");f.prop("disabled",!0),f.html(e.val())},e.prototype._CreateFixedHeaderRow=function(){var a=this._KGrid.table.find("thead").clone();this._FixedHeaderRow=b('<table style="position: fixed; top: 0px; left: 50%; display: none;">'),this._FixedHeaderRow.append(a),this._JqObj.append(this._FixedHeaderRow),this._UpdateFixedHeader()},e.prototype._DataBoundRedrawLoop=function(a){var b=this._KGrid.dataSource.data().length,c=this._KGrid.table.find("tr[role=row]").length;if(b!==c){var d=this;window.setTimeout(function(){d._DataBoundRedrawLoop(a)},100)}else a()},e.prototype._UpdateFixedHeader=function(){this._DetectFixedHeaderPositions(),this._CalculateFixedHeaderSize()},e.prototype._DetectFixedHeaderPositions=function(){this._FixedHeaderTop=this._KGrid.table.offset().top,this._FixedHeaderBottom=this._FixedHeaderTop+this._KGrid.table.height()-50},e.prototype._CalculateFixedHeaderSize=function(){for(var a=this._KGrid.table.find("th"),c=this._FixedHeaderRow.find("th"),d=0;d<a.length;d++){var e=b(c[d]),f=b(a[d]);e.width(f.width()),e.text(f.text())}this._FixedHeaderRow.width(this._KGrid.table.find("thead").width()),this._FixedHeaderRow.css("margin-left",this._FixedHeaderRow.width()/2*-1)},e.prototype._AttachHandlers=function(){var a=this;this._KGrid.dataSource.bind("error",function(b){b.errors!==c?a.DisplayErrors(b.errors):b.xhr!==c&&500==b.xhr.status?a.DisplayError("An unrecoverable server error occured (500).  Your request was not saved."):a.DisplayError("An unrecoverable grid error occured.  Your request was not saved.")}),this._KGrid.bind("dataBound",function(b){0===a._KGrid.dataSource.data().length&&a.DisplayNoResults(),a._DataBoundRedrawLoop(function(){a._UpdateFixedHeader()})}),this._KGrid.bind("columnResize",function(b){a._UpdateFixedHeader()}),this._KGrid.bind("edit",function(b){if(b.model.isNew()){var c=b.container.closest("tr");a._AutoBindNewItemValues(c)}}),b(window).bind("scroll",function(){var c=b(this).scrollTop();c>=a._FixedHeaderTop&&c<=a._FixedHeaderBottom?a._FixedHeaderRow.show():(c<a._FixedHeaderTop||c>a._FixedHeaderBottom)&&a._FixedHeaderRow.hide()})},e.prototype._AutoBindNewItemValues=function(a){for(var c=this._KGrid.dataItem(a),d=a.find("td"),e=0;e<d.length;e++){var f=this._ControlForAutoBinding(d[e]);if(f.length>0){var g=b(d[e]).data("containerFor");c[g]=f.val()}}},e.prototype._ControlForAutoBinding=function(a){var c=b(a).find(".k-dropdown input");return c},e.prototype.DisplayError=function(a){this.DisplayErrors({Error:{errors:[a]}})},e.prototype.DisplayErrors=function(a){var b="";for(var c in a)for(var d=a[c].errors,e=0;e<d.length;e++)b+=c+": "+d[e]+"\n";window.alert(b),this._KGrid.cancelChanges()},e.prototype.DisplayNoResults=function(){if(this._Options.ShowNoRecordsMessage){var a='<tr class="kendo-data-row s-empty-results"><td colspan="'+this._GetColumnCount()+'">No records found.</td></tr>';this._KGrid.table.append(a)}},d.GridHelper=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Ajax"),e=a.Ui.UiComponentBase.extend(function(a){this._MyBaseCtor(a),this._EntityId=a.EntityId,this._PropertyName=a.PropertyName,this._UpdateUrl=a.UpdateUrl,this._EntityTypeName=a.EntityTypeName,this._ModelTypeName=a.ModelTypeName,this._Value=null,this._PreviousValue=null});e.prototype.Render=function(a){var c=b(a);this._Value=this._PreviousValue=c.val();var d=b(document.createElement("div"));d.addClass("s-inline-editor-container"),d.prop("id",c.prop("id")),this._RenderDisplay(d),this._RenderEditor(d),this._RenderErrorDisplay(d),this._ShowDisplay(),d.data("sorisInlineEditor",this),c.replaceWith(d)},e.prototype._RenderDisplay=function(a){this._Display=b("<span>"),this._Display.addClass("s-display");var c=this;this._Display.on("click",function(){c._ShowEditor()}),a.append(this._Display)},e.prototype._RenderEditor=function(a){this._Editor=b("<input>"),this._Editor.addClass("s-editor"),this._Editor.val(this._Value),this.UiComponentFactory.RenderEditor(this._Editor,{});var c=this;this._Editor.on("blur",function(){c._Update(),c._ShowDisplay()}),a.append(this._Editor)},e.prototype._RenderErrorDisplay=function(a){this._ErrorDisplay=b("<span>"),this._ErrorDisplay.addClass("s-error-display"),a.append(this._ErrorDisplay)},e.prototype._ShowEditor=function(){this._Display.hide(),this._Editor.show(),this._Editor.focus()},e.prototype._ShowDisplay=function(){""===this._Value?this._Display.text(this._PropertyName):this._Display.text(this._Value),this._Display.show(),this._Editor.hide()},e.prototype._HandleFailedUpdate=function(a){this._Value=this._PreviousValue,this._ShowEditor();for(var b="",c=0;c<a.length;c++)b+=a[c]+"<br />";this._ErrorDisplay.html(b)},e.prototype._Update=function(){this._ErrorDisplay.text(""),this._Value=this._Editor.val();var a=this;b.ajax({type:"POST",url:this._UpdateUrl,data:{id:this._EntityId,property:this._PropertyName,value:this._Value,entityTypeName:this._EntityTypeName,modelTypeName:this._ModelTypeName},success:function(b,c){"Success"!==b.Result&&a._HandleFailedUpdate(b.Errors)},error:function(){a._HandleFailedUpdate(["An error occured while saving your change, please try again."])}})},d.InlineEditor=e}(window.Soris,jQuery),function(a,b,c){"use strict";b.fn.sorisInlineEditor=function(b){this.each(function(){var c=new a.Ajax.InlineEditor(b);c.Render(this)})}}(Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=a.Ui.UiComponentBase.extend(function(a){this._MyBaseCtor(),this._options=a,this.WidgetID=a.WidgetID,this.id=a.WidgetID,this._Title=a.Title||"Untitled",this._requestMediator=this._resolveMediator(),this.Header=null,this._Filters=a.Filters||[],this.CrossLinkOptions={Enable:a.EnableCrossLink||!1,Url:a.CrossLinkUrl||null,CrossLinkEventHandler:a.CrossLinkEventHandler||null,AdditionalParameters:a.CrossLinkAdditionalParameters!==c?a.CrossLinkAdditionalParameters:[]},this._CurrentDataSets=[],this._init()});e.prototype._resolveMediator=function(){return a.Utility.isUndefined(this._options.mediator)||null===this._options.mediator?d.WidgetRequestMediator.getUnmanagedMediator():this._options.mediator},e.prototype._init=function(){this._requestMediator.registerWidget(this),this._loadingImageHtml='<span class="s-widget-loading-image" />'},e.prototype.loadDataSets=function(a,b){this._hideMask(),this._CurrentDataSets=a,this._CurrentGlobalResponse=b||{},this._RefreshDataSetSelector(),this._CurrentDataSets.length>0&&this._SelectDataSet(0)},e.prototype.LoadDataSets=function(a,b){return this.loadDataSets(a,b)},e.prototype.DisplayDataSet=function(a,b){},e.prototype._RefreshDataSetSelector=function(){for(var a=[],b=0;b<this._CurrentDataSets.length;b++)a.push({text:this._CurrentDataSets[b].Name,value:b});this._DataSetSelector.LoadValues(a)},e.prototype._SelectDataSet=function(a){var b=this._CurrentDataSets[a],c=this._CurrentGlobalResponse;this.DisplayDataSet(b.Data,c)},e.prototype.Requery=function(){this._requestMediator.widgetChanged(this)},e.prototype.getRequestData=function(){var a=this._GetFilterParameters();return{WidgetID:this.WidgetID,Parameters:a}},e.prototype.GetRequestData=function(){return this.getRequestData()},e.prototype.showError=function(a){this._mask.addClass("s-mask-error");var b="<p>"+a+"</p>";this._showMaskedContent(b)},e.prototype.showLoadingMask=function(){this._showMaskedContent(this._loadingImageHtml)},e.prototype.hideLoadingMask=function(){this._hideMask()},e.prototype._showMaskedContent=function(a){this._maskContent.html(a),this._positionMask(),this._mask.show(),this._maskContent.show()},e.prototype._hideMask=function(){this._mask.hide(),this._maskContent.hide()},e.prototype._GetFilterParameters=function(){for(var a=[],b=0;b<this._Filters.length;b++)a.push({key:this._Filters[b].ParameterName,value:this._Filters[b].GetValue()});return a},e.prototype.OnCrossLink=function(a){if(this.CrossLinkOptions.Enable===!0){var c=b.Event("crossLink");c.Url=this.CrossLinkOptions.Url,c.Parameters=this.GetCrossLinkParameters(a);var d=this._Manager.GetGlobalFilterParameters();b.extend(c.Parameters,d),b(this).trigger(c),c.isDefaultPrevented()||window.open(this._GetCrossLinkUrl(c),"_blank")}},e.prototype._GetCrossLinkUrl=function(a){var b="";for(var c in a.Parameters)b+=c+"="+encodeURIComponent(a.Parameters[c])+"&";return b.length>0?a.Url+"?"+b.substring(0,b.length-1):a.Url},e.prototype.GetCrossLinkParameters=function(a){return{}},e.prototype.Render=function(a){var c=b(a),d=b(document.createElement("div"));d.addClass("s-widget-container"),d.prop("id",c.prop("id")),this.RenderHeader(d),this.RenderWidget(d,this),this.RenderFilters(d),this.RenderFooter(d),this._renderMask(d),d.data("sorisWidget",this),d.data("sorisWidgetId",this._WidgetID),c.replaceWith(d),this._AttachEvents()},e.prototype._AttachEvents=function(){var a=this;this._AttachCrossLink(),b(this._DataSetSelector).on("select",function(b){a._SelectDataSet(b.value)})},e.prototype._AttachCrossLink=function(){var a;switch(typeof this.CrossLinkOptions.CrossLinkEventHandler){case"string":a=window[this.CrossLinkOptions.CrossLinkEventHandler];break;case"function":a=this.CrossLinkOptions.CrossLinkEventHandler;break;default:return}b(this).on("crossLink",a)},e.prototype._renderMask=function(a){a.css("position","relative"),this._mask=b("<div>").addClass("s-widget-mask").css({position:"absolute",top:0,left:0}),this._maskContent=b("<div>").addClass("s-widget-mask-content").css({position:"absolute",top:0,left:0}),a.append(this._mask),a.append(this._maskContent)},e.prototype._positionMask=function(){var a=this._mask.parent();this._mask.css({height:a.height(),width:a.width()});var b=a.height()/2,c=this._maskContent.height()/2,d=a.width()/2,e=this._maskContent.width()/2;this._maskContent.css({marginTop:b-c,marginLeft:d-e})},e.prototype.RenderHeader=function(c){this.Header=b("<div>").addClass("s-widget-header"),this.Header.append(b("<h3>"+this._Title+"</h3>")),this._DataSetSelector=new a.Ui.ShowMoreSelector,this._DataSetSelector.Render(this.Header),c.append(this.Header)},e.prototype.RenderFilters=function(a){for(var c=this,d=function(a){c.Requery()},e=0;e<this._Filters.length;e++){var f=b(document.createElement("span"));f.addClass("s-filter-container"),f.data("sorisFilter",this._Filters[e]),a.append(f),b(this._Filters[e]).on("filter",d),this._Filters[e].Render(f)}},e.prototype.RenderFooter=function(a){},e.prototype.RenderWidget=function(a,b){},d.WidgetBase=e}(window.Soris,jQuery),function(a,b,c,d){"use strict";var e=a.namespace("Widgets"),f=e.WidgetBase.extend(function(a){this._MyBaseCtor(a),this._Arrow=null,this._Label=null,this._Footer=null,this._AmountFormatString=a.AmountFormatString||"{0}",this._AmountChangedFormatString=a.AmountChangedFormatString||"{0}",this._FooterFormatString=a.FooterFormatString||"{0} by {1} from the same time period last year.",this._ColorCodePositiveResult=a.ColorCodePositiveResult||!1,this._DisplayAmountChangedText=a.DisplayAmountChangedText||!1,this._DisplayDirectionChangeArrow=a.DisplayDirectionChangeArrow||!1});f._DirectionUp=1,f._DirectionDown=2,f.prototype._SetPositiveResultClasses=function(){this._Label.addClass("s-positive-change"),this._Label.removeClass("s-negative-change"),this.Header.addClass("s-positive-change"),this.Header.removeClass("s-negative-change")},f.prototype._SetNegativeResultClasses=function(){this._Label.addClass("s-negative-change"),this._Label.removeClass("s-positive-change"),this.Header.addClass("s-negative-change"),this.Header.removeClass("s-positive-change")},f.prototype._SetAmountText=function(a){var b=c.format(this._AmountFormatString,a);this._Label.text(b)},f.prototype._SetFooterText=function(a,b){var d=c.format(this._AmountChangedFormatString,a),e=b===f._DirectionUp?"Up":"Down",g=c.format(this._FooterFormatString,e,d);this._Footer.text(g)},f.prototype._ConfigureArrow=function(a,b){a===f._DirectionUp?(this._Arrow.prop("alt","Up"),this._Arrow.addClass("s-sprite-up-arrow"),this._Arrow.removeClass("s-sprite-down-arrow")):(this._Arrow.prop("alt","Down"),this._Arrow.addClass("s-sprite-down-arrow"),this._Arrow.removeClass("s-sprite-up-arrow")),b?(this._Arrow.addClass("s-sprite-green"),this._Arrow.removeClass("s-sprite-red")):(this._Arrow.addClass("s-sprite-red"),this._Arrow.removeClass("s-sprite-green"))},f.prototype.DisplayDataSet=function(a){this._ConfigureArrow(a.Direction,a.PositiveResult),this._ColorCodePositiveResult===!0&&(a.PositiveResult===!0?this._SetPositiveResultClasses():this._SetNegativeResultClasses()),this._SetAmountText(a.Amount),this._SetFooterText(a.AmountChanged,a.Direction)},f.prototype.RenderWidget=function(a){var c=b(document.createElement("div"));c.addClass("s-widget"),this._Arrow=b(document.createElement("span")),this._Arrow.addClass("s-sprite"),c.append(this._Arrow),this._Label=b(document.createElement("span")),this._Label.addClass("s-dchange-amount"),c.append(this._Label),a.addClass("s-direction-change-widget"),a.append(c)},f.prototype._ApplyDisplaySettings=function(){this._DisplayDirectionChangeArrow||this._Arrow.hide(),this._DisplayAmountChangedText||this._Footer.hide()},f.prototype.RenderFooter=function(a){this._Footer=b(document.createElement("div")),this._Footer.addClass("s-widget-footer"),a.append(this._Footer),this._ApplyDisplaySettings()},e.DirectionChangeWidget=f}(window.Soris,jQuery,kendo),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=d.WidgetBase.extend(function(c){this._MyBaseCtor(c),this.options=a.Utility.loadDefaults({ValueFormat:"{0}",CategoryFormat:"{0}",MaxCharactersInCategory:null,ShowLegend:!1,CategoryDataType:"string",ValueDataType:"float"},c),this._Chart=null,this._ChartType=c.ChartType||"pie",this._NoDataTemplate=null,this._ChartDomElement=null,b.extend(this.CrossLinkOptions,{ValuePropertyName:c.CrossLinkValueParameterName,CategoryPropertyName:c.CrossLinkCategoryParameterName}),this.ChartFactory=new d.KendoChartFactory});e.prototype.DisplayDataSet=function(a,b){0===a.Data.length?this._ShowNoDataTemplate():(("string"!==this._CategoryDataType||"string"!==this._ValueDataType)&&this._ParseResponseDataTypes(a),this._ShowChart(),this._Chart.LoadData(a,b))},e.prototype._ParseResponseDataTypes=function(a){for(var b=this._GetParserByDataType(this.options.CategoryDataType),c=this._GetParserByDataType(this.options.ValueDataType),d=0;d<a.Data.length;d++){var e=a.Data[d];e.Category=b(e.Category);for(var f=0;f<a.SeriesNames.length;f++){var g=a.SeriesNames[f];e[g]=c(e[g])}}},e.prototype._GetParserByDataType=function(b){return a.Utility.getParser(b)},e.prototype.GetCrossLinkParameters=function(a){var b={};this.CrossLinkOptions.ValuePropertyName!==c&&(b[this.CrossLinkOptions.ValuePropertyName]=a.value),this.CrossLinkOptions.CategoryPropertyName!==c&&(b[this.CrossLinkOptions.CategoryPropertyName]=a.category);for(var d=0;d<this.CrossLinkOptions.AdditionalParameters.length;d++){var e=this.CrossLinkOptions.AdditionalParameters[d];b[e]=a.dataItem[e]}return b},e.prototype.RenderWidget=function(a,b){this._RenderNoDataTemplate(a),this._RenderChart(a,b),this._ShowNoDataTemplate()},e.prototype._RenderNoDataTemplate=function(a){var c=b(document.createElement("div"));c.addClass("s-no-data"),c.text("No records matched your search criteria.  Could not create chart."),this._NoDataTemplate=c,a.append(c)},e.prototype._RenderChart=function(a,c){var d=b(document.createElement("div"));switch(d.addClass("s-widget").addClass("s-chart"),this._ChartType){case"pie":a.addClass("s-pie-chart-widget"),this._Chart=this.ChartFactory.RenderPieChart(d,c,this.options);break;case"bar":a.addClass("s-bar-chart-widget"),this._Chart=this.ChartFactory.RenderBarChart(d,c,this.options);break;case"line":a.addClass("s-line-chart-widget").addClass("s-scrollable-widget-container"),this._Chart=this.ChartFactory.RenderLineChart(d,c,this.options)}this._ChartDomElement=d,a.append(d)},e.prototype._ShowNoDataTemplate=function(){this._ChartDomElement.hide(),this._NoDataTemplate.show()},e.prototype._ShowChart=function(){this._ChartDomElement.show(),this._NoDataTemplate.hide()},d.ChartWidget=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=a.Class.extend(function(){});e.prototype.RenderPieChart=function(a,b,c){throw"Provider must implement RenderPieChart"},e.prototype.RenderBarChart=function(a,b,c){throw"Provider must implement RenderBarChart"},e.prototype.RenderLineChart=function(a,b,c){throw"Provider must implement RenderLineChart"},d.ChartFactory=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=a.Class.extend(function(a){this._ElideCategories=a.MaxCharactersInCategory&&("string"===a.CategoryDataType||!a.CategoryDataType),this._MaxCharactersInCategory=a.MaxCharactersInCategory});e.prototype.LoadData=function(a,b){var c=this._parseSeriesNames(a.SeriesNames);a=a.Data,this._PrepareData(a),this.p_loadPreparedData(a,c),this.p_setSeriesToDisplay(c),this.p_displayNotes(b.notes),this.p_redrawChart()},e.prototype._parseSeriesNames=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c].split("|"),e={name:d.length>1?d[1]:d[0],field:d[0]};b.push(e)}return b},e.prototype._PrepareData=function(a){if(this._ElideCategories)for(var b=0;b<a.length;b++)a[b].FullCategory=a[b].Category,a[b].ElidedCategory=a[b].Category.length>this._MaxCharactersInCategory?a[b].Category.substring(0,this._MaxCharactersInCategory+1)+"...":a[b].Category},e.prototype.p_loadPreparedData=function(a,b){throw"Chart must implement p_loadPreparedData"},e.prototype.p_setSeriesToDisplay=function(a){throw new Error("Chart must implement p_setSeriesToDisplay")},e.prototype.p_displayNotes=function(a){throw new Error("Chart must implement p_displayNotes")},e.prototype.p_redrawChart=function(){throw new Error("Chart must implement p_redrawChart")},d.ChartBase=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=d.ChartBase.extend(function(a,b){this._MyBaseCtor(b),this._KendoChart=a});e.prototype.p_loadPreparedData=function(a,b){this._KendoChart.dataSource.data(a)},e.prototype.p_setSeriesToDisplay=function(a){this._KendoChart.options.series.length=0;for(var b=0;b<a.length;b++)this._KendoChart.options.series.push({type:"column",categoryField:"Category",field:a[b].field})},e.prototype.p_displayNotes=function(a){console.warn("KendoBarChartWrapper does not display notes.")},e.prototype.p_redrawChart=function(){this._KendoChart.refresh(),this._KendoChart.redraw()},d.KendoBarChartWrapper=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=a.Widgets.ChartFactory.extend(function(){this._MyBaseCtor()});e.prototype.RenderPieChart=function(b,c,d){var e=d.MaxCharactersInCategory&&("string"===d.CategoryDataType||!d.CategoryDataType),f={legend:{labels:{template:e?'#: dataItem.ElidedCategory #: #: kendo.toString(percentage, "%") #%':'#: text #: #: kendo.toString(percentage, "%") #%'},visible:d.ShowLegend,position:"bottom"},plotArea:{padding:0},seriesDefaults:{labels:{visible:!d.ShowLegend,position:"center",background:"transparent",template:'#= category #: #= kendo.toString(percentage, "%") #%'}},series:[{type:"pie",padding:15,field:"Value1",categoryField:"Category"}],dataSource:new kendo.data.DataSource({data:[]}),chartArea:{width:250,height:250},tooltip:{visible:d.ShowLegend,template:e?"#: dataItem.FullCategory #: ${kendo.toString(percentage, '%')}%":"${category}: ${kendo.toString(percentage, '%')}%"},seriesClick:function(a){c.OnCrossLink(a)}},g=b.kendoChart(f).data("kendoChart");return new a.Widgets.KendoPieChartWrapper(g,d)},e.prototype.RenderLineChart=function(b,c,d){var e={legend:{visible:!1},plotArea:{padding:0},chartArea:{width:500,height:350},series:[{type:"line",padding:15,field:"Value1",categoryField:"Category"}],dataSource:new kendo.data.DataSource({data:[]}),valueAxis:{labels:{format:d.ValueFormat},line:{visible:!1}},categoryAxis:{labels:{format:d.CategoryFormat,rotation:-90}},tooltip:{visible:!0,template:'#= kendo.format("{0:'+d.CategoryFormat+'}", category) #: #= kendo.format("'+d.ValueFormat+'", value) #'},seriesClick:function(a){c.OnCrossLink(a)}},f=b.kendoChart(e).data("kendoChart");return new a.Widgets.KendoLineChartWrapper(f,d)},e.prototype.RenderBarChart=function(b,c,d){var e={legend:{visible:!1},plotArea:{padding:0},chartArea:{width:500,height:350},series:[{type:"column",padding:15,field:"Value1",categoryField:"Category"}],dataSource:new kendo.data.DataSource({data:[]}),valueAxis:{labels:{format:d.ValueFormat},line:{visible:!1}},categoryAxis:{labels:{format:d.CategoryFormat,rotation:-90}},tooltip:{visible:!0,template:'#= kendo.format("'+d.CategoryFormat+'", category) #: #= kendo.format("'+d.ValueFormat+'", value) #'},seriesClick:function(a){c.OnCrossLink(a)}},f=b.kendoChart(e).data("kendoChart");return new a.Widgets.KendoBarChartWrapper(f,d)},d.KendoChartFactory=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=function(){function a(){this.calculators=[]}return a.prototype.registerMaxMinCalculator=function(a,b){this.calculators.push({name:a,min:null,max:null,getValues:b})},a.prototype.calculateResults=function(a){this.executeCalculators(a);for(var b={},c=0;c<this.calculators.length;c++)b[this.calculators[c].name]={min:this.calculators[c].min,max:this.calculators[c].max};return b},a.prototype.executeCalculators=function(a){for(var b=0;b<a.length;b++)for(var c=a[b],d=0;d<this.calculators.length;d++){var e=this.calculators[d],f=e.getValues(c);(null===e.min||e.min>f.min)&&(e.min=f.min),(null===e.max||e.max<f.max)&&(e.max=f.max)}},a}(),f=d.ChartBase.extend(function(b,c){this._MyBaseCtor(c);var d=a.Utility.loadDefaults({majorUnitCeiling:500,verticalMaxCeiling:1e3},c);this.options=a.Utility.loadDefaults(this.options,d),this._KendoChart=b,this._MajorSteps=10,this._MinimumStepPaddingPercent=1.1,this._MaxOnYAxis=20,this._MaxOnXAxis=30,this.width=b.options.chartArea.width,this.dataPointWidth="undefined"!=typeof c.dataPointWidth?c.dataPointWidth:30,this.valueLabelPadding="undefined"!=typeof c.valueLabelPadding?c.valueLabelPadding:100});f.prototype.CeilToMultiple=function(a,b){var c=a/b,d=Math.ceil(c);return b*d},f.prototype.p_displayNotes=function(b){if("undefined"!=typeof b){this._ensureProperty(this._KendoChart.options.categoryAxis,"notes",{line:{},data:[]}),this._ensureProperty(this._KendoChart.options.categoryAxis.notes,"line",{}),this._ensureProperty(this._KendoChart.options.categoryAxis.notes,"data",[]),this._KendoChart.options.categoryAxis.notes.data.length=0;for(var c=a.Utility.getParser(this.options.CategoryDataType),d=0;d<b.length;d++)this._KendoChart.options.categoryAxis.notes.data.push({value:c(b[d].value),label:{template:b[d].text},link:b[d].link});this._KendoChart.options.categoryAxis.notes.line.length=100;var e=this;this._KendoChart.bind("noteClick",function(a){e._handleCategoryNoteClickByValue(a.value)})}},f.prototype._handleCategoryNoteClickByValue=function(b){var c=this._findCategoryNoteByValue(b);
null!==c&&a.Utility.redirect(c.link)},f.prototype._findCategoryNoteByValue=function(b){for(var c=a.Utility.getComparer(this.options.CategoryDataType),d=this._KendoChart.options.categoryAxis.notes.data,e=0;e<d.length;e++)if(0===c(b,d[e].value))return d[e];return null},f.prototype._ensureProperty=function(a,b,c){"undefined"==typeof a[b]&&(a[b]=c)},f.prototype.p_loadPreparedData=function(a,b){var c=new e;if(c.registerMaxMinCalculator("yAxis",function(a){for(var c=null,d=null,e=0;e<b.length;e++){var f=b[e].field,g=a[f];(null===c||c>g)&&(c=g),(null===d||g>d)&&(d=g)}return{min:c,max:d}}),"number"===this.options.CategoryDataType)c.registerMaxMinCalculator("xAxis",function(a){return{max:a.Category,min:a.Category}});else if("date"===this.options.CategoryDataType)c.registerMaxMinCalculator("xAxis",function(a){var b=864e5,c=a.Category.getTime()/b;return{max:c,min:c}}),this._KendoChart.options.categoryAxis.baseUnit="days";else{var d=0;c.registerMaxMinCalculator("xAxis",function(a){return{max:++d,min:0}})}var f=c.calculateResults(a),g=f.yAxis.max/this._MajorSteps;g*=this._MinimumStepPaddingPercent;var h=this.CeilToMultiple(g,this.options.majorUnitCeiling);this._KendoChart.options.valueAxis.majorUnit=h,this._KendoChart.options.valueAxis.max=this.CeilToMultiple(f.yAxis.max+h,this.options.verticalMaxCeiling);var i=f.yAxis.max/h;if(i>this._MaxOnYAxis){var j=a.length/this._MaxOnYAxis;this._KendoChart.options.valueAxis.majorUnit=h*j}this._configureChartAreaForData(a,f),this._KendoChart.dataSource.data(a)},f.prototype._configureChartAreaForData=function(a,b){var c=b.xAxis.max-b.xAxis.min,d=c*this.dataPointWidth+this.valueLabelPadding,e=d>this.width?d:this.width;this._KendoChart.options.chartArea.width=e},f.prototype.p_setSeriesToDisplay=function(a){this._KendoChart.options.series.length=0;for(var b=0;b<a.length;b++)this._KendoChart.options.series.push({type:"line",categoryField:"Category",field:a[b].field,name:a[b].name});a.length>1?this._showLegend():this._hideLegend()},f.prototype._showLegend=function(a){"undefined"==typeof a&&(a="bottom"),this._KendoChart.options.legend={visible:!0,position:a}},f.prototype._hideLegend=function(){this._KendoChart.options.legend={visible:!1}},f.prototype.p_redrawChart=function(){this._KendoChart.refresh(),this._KendoChart.redraw()},d.KendoLineChartWrapper=f}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=d.ChartBase.extend(function(a,b){this._MyBaseCtor(b),this._KendoChart=a});e.prototype.p_loadPreparedData=function(a,b){this._KendoChart.dataSource.data(a)},e.prototype.p_setSeriesToDisplay=function(a){if(a.length>1)throw new Error("KendoPieChartWrapper only supports up to 1 series!");this._KendoChart.options.series.length=0;for(var b=0;b<a.length;b++)this._KendoChart.options.series.push({type:"pie",categoryField:"Category",field:a[b].name})},e.prototype.p_displayNotes=function(a){console.warn("KendoPieChartWrapper does not display notes.")},e.prototype.p_redrawChart=function(){this._KendoChart.refresh(),this._KendoChart.redraw()},d.KendoPieChartWrapper=e}(window.Soris,jQuery),function(a){"use strict";var b=a.namespace("Widgets");b.WIDGET_REQUEST_CONNECTION_STATUS={OPEN:1,CLOSED:2};var c=b.WIDGET_REQUEST_CONNECTION_STATUS,d=a.Class.extend(function(){this._pendingReceives=[],this._receiveCallback=null,this.status=c.OPEN});d.prototype.send=function(a,b){throw new Error("type must implement send!")},d.prototype.receive=function(a){if(this.status===c.CLOSED)throw new Error("cannot receive when closed!");this._receiveCallback=a;for(var b=0;b<this._pendingReceives.length;b++){var d=this._pendingReceives[b];this._receiveCallback(d.err,d.data)}this._pendingReceives.length=0},d.prototype._receiveOrPending=function(a,b){null!==this._receiveCallback?this._receiveCallback(a,b):this._pendingReceives.push({err:a,data:b})},d.prototype.p_dataReceived=function(a){this._receiveOrPending(null,a)},d.prototype.p_errorReceived=function(a,b){this._receiveOrPending(a,b)},d.prototype.close=function(){throw new Error("type must impelement close!")},d.prototype.onClosed=function(){var a=$.Event("closed");$(this).trigger(a)},d.prototype.sendComplete=function(){this.p_sendCompleted=!0,this._receiveCompleted===!0&&this.close()},d.prototype.p_receiveComplete=function(){this._receiveCompleted=!0,this.p_sendCompleted===!0&&this.close()},b.WidgetRequestConnectionBase=d}(window.Soris),function(a,b){"use strict";var c=a.namespace("Widgets"),d=c.WIDGET_REQUEST_CONNECTION_STATUS,e=c.WidgetRequestConnectionBase.extend(function(a){this._MyBaseCtor(a),this._activeAjaxRequests=[],this._options=a});e.prototype.send=function(a){if(this.status===d.CLOSED)throw new Error("Could not send request because the connection is closed!");var c=b.ajax({url:this._options.url,dataType:"json",contentType:"application/json; charset=utf-8",type:"POST",data:JSON.stringify(a)});this._addActiveRequest(c);var e=this;c.done(function(a,b,d){e.p_dataReceived(a),e._removeActiveRequest(c)}),c.fail(function(a,b,d){e.p_errorReceived(a.responseText||a.statusText,d),e._removeActiveRequest(c)})},e.prototype._addActiveRequest=function(a){this._activeAjaxRequests.push(a)},e.prototype._removeActiveRequest=function(a){for(var b=0;b<this._activeAjaxRequests.length;b++)if(this._activeAjaxRequests[b]===a){this._activeAjaxRequests.splice(b,1);break}this.p_sendCompleted&&0===this._activeAjaxRequests.length&&this.p_receiveComplete()},e.prototype.close=function(){for(var a=0;a<this._activeAjaxRequests.length;a++)this._activeAjaxRequests[a].abort();this.status=d.CLOSED},c.AjaxWidgetRequestConnection=e}(window.Soris,jQuery),function(a,b,c){var d=a.namespace("Widgets"),e=a.Class.extend(function(){});e.prototype.open=function(){throw new Error("type must implement open!")},d.WidgetRequestMediaBase=e}(window.Soris,jQuery),function(a,b,c){var d=a.namespace("Widgets"),e=d.WidgetRequestMediaBase.extend(function(a){this.options=a});e.prototype.open=function(){return new d.AjaxWidgetRequestConnection(this.options)},d.AjaxWidgetRequestMedia=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets"),e=d.WIDGET_REQUEST_CONNECTION_STATUS,f=a.Class.extend(function(a){this.options=a,this._globalFilters=[],this._widgets=[],this._recordsGrid=null,this._currentConnection=null,this._init()});f.getUnmanagedMediator=function(){return a.Utility.isUndefined(f._unmanagedMediator)&&(f._unmanagedMediator=new f({})),f._unmanagedMediator},f.prototype._init=function(){var c=d.PageConfiguration.resolve();this._requestMedia=this.options.requestMedia,a.Utility.isUndefined(this._requestMedia)&&(this._requestMedia=c.resolveRequestMedia()),this.options.globalQueryUrl=c.options.globalQueryUrl,this.globalQueryDataQueue=function(){function a(){this.queue=[],this.state=b.NO_DATA_AVAILABLE,this.data=null}var b={DATA_AVAILABLE:"DATA_AVAILABLE",NO_DATA_AVAILABLE:"NO_DATA_AVAILABLE"};return a.prototype.enqueueWorkItem=function(a){this.state===b.NO_DATA_AVAILABLE?this.queue.push(a):this.state===b.DATA_AVAILABLE&&a(this.data)},a.prototype.loadData=function(a){for(var c=0;c<this.queue.length;c++){var d=this.queue[c];d(a)}this.queue.length=0,this.data=a,this.state=b.DATA_AVAILABLE},a.prototype.clearData=function(){this.data=null,this.state=b.NO_DATA_AVAILABLE},new a}();var e=this;b(window).on("beforeunload",function(){null!==e._currentConnection&&e._currentConnection.close()})},f.prototype.cancelPendingRequests=function(){for(var a=0;a<this._widgets.length;a++)this._widgets[a].hideLoadingMask()},f.prototype.runGlobalQuery=function(a){this.globalQueryDataQueue.clearData();var c=this;b.ajax({url:this.options.globalQueryUrl,dataType:"json",contentType:"application/json; charset=utf-8",type:"POST",data:JSON.stringify({requests:[],globalFilters:a.asKeyValueArray})}).then(function(a){if(null!==a.Errors&&a.Errors.length>0)c.showErrors(a.Errors),c.cancelPendingRequests();else{c.globalQueryDataQueue.loadData(a);var d=b.Event("globalQueryCompleted");d.globalResponse=a,b(c).trigger(d)}})},f.prototype.showErrors=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c]+"\n";this.showGeneralError(b)},f.prototype.showGeneralError=function(a){alert(a)},f.prototype.globalChanged=function(){var a=this._getGlobalFilterValues();if(a.validationErrors.length>0)this.showGeneralError(a.validationErrors.join("\n"));else{this.runGlobalQuery(a),this._ensureConnection(!0);for(var b=0;b<this._widgets.length;b++)this._widgets[b].showLoadingMask(),this._currentConnection.send(this._createRequest(this._widgets[b],a));this._refreshRecordsGrid(a)}},f.prototype._createRequest=function(b,c){return a.Utility.isUndefined(c)&&(c=this._getGlobalFilterValues()),{requests:[b.getRequestData()],globalFilters:c.asKeyValueArray}},f.prototype.widgetChanged=function(a){a.showLoadingMask(),this._ensureConnection(!1),this._currentConnection.send(this._createRequest(a))},f.prototype._ensureConnection=function(a){if(null!==this._currentConnection&&this._currentConnection.status===e.OPEN){if(!a)return;this._currentConnection.close()}this._currentConnection=this._requestMedia.open();var b=this;this._currentConnection.receive(function(a,c){var d=null,e=null;if("object"==typeof c&&"Responses"in c&&"WidgetID"in c.Responses[0]&&(d=c.Responses[0],e=b._getWidgetById(d.WidgetID)),null===a){var f=d.DataSets;b.globalQueryDataQueue.enqueueWorkItem(function(a){e.loadDataSets(f,a)})}else null!==e&&"abort"!==a?e.showError(a):"abort"!==a&&b.showGeneralError(a)})},f.prototype._getWidgetById=function(a){for(var b=0;b<this._widgets.length;b++)if(this._widgets[b].id===a)return this._widgets[b];throw new Error("could not find a widget with '"+a+"' id.  Did you call registerWidget?")},f.prototype.registerRecordsGrid=function(b){if(!(b instanceof a.Ui.GridBase))throw new Error("recordsGrid was not a valid Widgets.RecordsGrid!");this._recordsGrid=b;var c=this._getGlobalFilterValues();this._refreshRecordsGrid(c)},f.prototype._refreshRecordsGrid=function(a){null!==this._recordsGrid&&this._recordsGrid.setStaticFilters(a.asKendoArray)},f.prototype.registerGlobalFilter=function(b){a.Utility.argumentRequired(b.parameterName,"parameterName"),a.Utility.argumentRequired(b.getValue,"getValue"),this._globalFilters.push(b)},f.prototype._getGlobalFilterValues=function(){for(var b={asHashtable:{},asKeyValueArray:[],asKendoArray:[],validationErrors:[]},c=0;c<this._globalFilters.length;c++){var d=this._globalFilters[c].parameterName,e=this._globalFilters[c].getValue();b.asKeyValueArray.push({key:d,value:e}),b.asHashtable[d]=e,a.Utility.isUndefined(e)||""===e||null===e||b.asKendoArray.push({field:d,operator:"eq",value:e}),[].push.apply(b.validationErrors,this._globalFilters[c].validate())}return b},f.prototype.registerWidget=function(b){a.Utility.argumentRequired(b.getRequestData,"getRequestData"),a.Utility.argumentRequired(b.loadDataSets,"loadDataSets"),a.Utility.argumentRequired(b.showError,"showError"),a.Utility.argumentRequired(b.showLoadingMask,"showLoadingMask"),a.Utility.argumentRequired(b.id,"id"),this._widgets.push(b)},d.WidgetRequestMediator=f}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets.Filters"),e=a.Ui.UiComponentBase.extend(function(a){this._MyBaseCtor(),this._TextBefore=a.TextBefore||"",this._TextAfter=a.TextAfter||"",this._Events=a.Events||{},this._NonFiltering=a.NonFiltering!==c?a.NonFiltering:!1,this.DefaultValue=a.DefaultValue!==c?a.DefaultValue:null,this.ParameterName=a.ParameterName||"Unknown Parameter Name",this.parameterName=this.ParameterName,this.DisplayTextParameterName=a.DisplayTextParameterName||"Unknown Display Text Parameter Name"});e.prototype.validate=function(){return[]},e.prototype._attachEvents=function(){for(var a in this._Events)this.p_attachEvent(a,this._Events[a]);var b=this;this.p_attachEvent("change",function(a){function c(a){setTimeout(a,0)}c(function(){a.isDefaultPrevented()||b.OnFilter()})})},e.prototype.getValue=function(){},e.prototype.GetValue=function(){return this.getValue()},e.prototype.AddHandler=function(a,b){this._Events[a]=b},e.prototype.OnFilter=function(){if(!this._NonFiltering){var a=b.Event("filter");b(this).trigger(a)}},e.prototype.Render=function(a){this.render(a)},e.prototype.render=function(a){this._renderStart(a);var c=b(document.createElement("input"));c.addClass("s-filter"),a.append(c),this.p_renderFilter(c),this._attachEvents(),this._renderEnd(a)},e.prototype._renderStart=function(a){var b=document.createTextNode(this._TextBefore);a.append(b)},e.prototype.p_renderFilter=function(a){throw new Error("Filter must implement p_renderFilter")},e.prototype.RenderFilter=function(a){this.p_renderFilter(a)},e.prototype.p_attachEvent=function(a,b){throw new Error("Filter must implement p_attachEvent")},e.prototype.AttachEvent=function(a,b){this.p_attachEvent(a,b)},e.prototype._renderEnd=function(a){var b=document.createTextNode(this._TextAfter);a.append(b)},d.FilterBase=e}(window.Soris,jQuery),function(a,b){"use strict";var c=a.namespace("Widgets.Filters"),d=c.FilterBase.extend(function(b){this._MyBaseCtor(b);(new Date).getFullYear();this._options=a.Utility.loadDefaults({required:!0},b)});d.prototype.p_renderFilter=function(a){this._dateInput=a,this._datePicker=this.p_uiComponentFactory.RenderDatePicker(a,{value:this._options.initialValue,change:0})},d.prototype.getValue=function(){return this._dateInput.val()},d.prototype.validate=function(){var b=[],c=this.getValue();return""!==c&&null!==c||!this._options.required?""===c||null===c||a.Utility.isDateValid(c)||b.push(this.ParameterName+": "+c+" is not a valid date."):b.push(this.ParameterName+" is required."),b},d.prototype.p_attachEvent=function(a,b){this._datePicker.on(a,b)},c.DateFilter=d}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets.Filters"),e=d.FilterBase.extend(function(a){this._MyBaseCtor(a),this.Options=a.Options||[],this.FilterInputField=null});e.prototype.p_renderFilter=function(a){this.FilterInputField=a,this.StartRenderFilter();for(var b=0;b<this.Options.length;b++)this.RenderOption(this.Options[b]);this.EndRenderFilter()},e.prototype.StartRenderFilter=function(){},e.prototype.RenderOption=function(a){},e.prototype.EndRenderFilter=function(){},d.OptionListFilterBase=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets.Filters"),e=d.OptionListFilterBase.extend(function(a){this._MyBaseCtor(a)});e.prototype.StartRenderFilter=function(){var a=b(document.createElement("span"));this.FilterInputField.replaceWith(a),this.FilterInputField=a},e.prototype.RenderOption=function(a){var c=document.createElement("input");c.type="radio",c.value=a.Value,c.name=this.ParameterName,a.Value===this.DefaultValue&&(c.checked=!0);var d=b(document.createElement("label"));d.append(c),d.append(document.createTextNode(a.Text)),this.FilterInputField.append(d)},e.prototype.p_attachEvent=function(a,b){this.FilterInputField.on(a,b)},e.prototype.getValue=function(){return this.FilterInputField.find("input:checked").val()},d.RadioButtonsFilter=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets.Filters"),e=d.OptionListFilterBase.extend(function(a){this._MyBaseCtor(a)});e.prototype.StartRenderFilter=function(){var a=b(document.createElement("select"));this.FilterInputField.replaceWith(a),this.FilterInputField=a},e.prototype.RenderOption=function(a){var b=document.createElement("option");b.value=a.Value,b.text=a.Text,this.FilterInputField.append(b)},e.prototype.GetValue=function(){return this.FilterInputField.val()},e.prototype.AttachEvent=function(a,b){this.FilterInputField.on(a,b)},d.DropDownListFilter=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets.Filters"),e=d.FilterBase.extend(function(a){if(this._MyBaseCtor(a),a.JqInput===c)throw"JqInput is a required option.";this._JqInput=a.JqInput,this._JqContainer=a.JqContainer!==c?a.JqContainer:a.JqInput});e.prototype.p_renderFilter=function(b){this._JqContainer.replaceAll(b),this._JqContainer.addClass("s-filter");var d=this._JqInput.data("kendoComboBox");if(d!==c){this.p_attachEvent=this._kendoAttachEvent;var e=a.Utility.getQstringParam(this.DisplayTextParameterName);""!==e&&d.input.val(e)}else this.p_attachEvent=this._jqAttachEvent},e.prototype.p_attachEvent=function(a,b){throw new Error("no attach event defined!")},e.prototype._jqAttachEvent=function(a,b){this._JqInput.on(a,b)},e.prototype._kendoAttachEvent=function(a,b){this._JqInput.data("kendoComboBox").bind(a,b)},e.prototype.getValue=function(){return this._JqInput.val()},e.prototype.GetText=function(){var a=this._JqInput.data("kendoComboBox");return a!==c?a.text():void 0},d.ExternalFilter=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets.Filters"),e=d.FilterBase.extend(function(a){this._MyBaseCtor(a),this._Max=a.Max!==c?a.Max:null,this._Min=a.Min!==c?a.Min:null,this._Format=a.Format||"#",this._Decimals=a.Decimals!==c?a.Decimals:0,this._Spinner=null,null===this.DefaultValue&&(this.DefaultValue=0)});e.prototype.GetValue=function(){return this._Spinner.val()},e.prototype.p_renderFilter=function(a){var b={format:this._Format,min:this._Min,max:this._Max,decimals:this._Decimals,value:this.DefaultValue};this._Spinner=this.UiComponentFactory.RenderSpinner(a,b)},e.prototype.p_attachEvent=function(a,b){this._Spinner.on(a,b)},d.NumericSpinnerFilter=e}(window.Soris,jQuery),function(a,b,c){"use strict";var d=a.namespace("Widgets.Filters"),e=d.FilterBase.extend(function(a){this._MyBaseCtor(a)});e.prototype.Render=function(a){},e.prototype.getValue=function(){return this.DefaultValue},e.prototype.p_renderFilter=function(a){a.prop("type","hidden")},e.prototype.p_attachEvent=function(a,b){},d.StaticValueFilter=e}(window.Soris,jQuery),function(a,b){"use strict";var c=a.namespace("Widgets"),d=a.namespace("Widgets.Filters"),e=(a.namespace("Ui"),a.Ui.UiComponentBase.extend(function(b){this._filters=[],this._options=a.Utility.loadDefaults({GlobalFilters:[]},b),this._requestMediator=this._resolveMediator(),this._processOptions()}));e.prototype._processOptions=function(){for(var a=0;a<this._options.GlobalFilters.length;a++)this.add(this._options.GlobalFilters[a])},e.prototype._resolveMediator=function(){return a.Utility.isUndefined(this._options.mediator)||null===this._options.mediator?c.WidgetRequestMediator.getUnmanagedMediator():this._options.mediator},e.prototype.add=function(a){this._filters.push(a),this._requestMediator.registerGlobalFilter(a)},e.prototype.render=function(a){a=b(a),this._createDateFilters();var c=b(document.createElement("div"));c.addClass("s-global-filter-panel"),c.prop("id",a.prop("id")),a.append(c),this._renderGlobalFilters(c),c.data("sorisGlobalFilterPanel",this)},e.prototype._createDateFilters=function(){var a=this,b=function(){a._requestMediator.globalChanged()};this._startDateFilter=new d.DateFilter({TextBefore:"From",ParameterName:"StartDate",initialValue:this._findInitialStartDate(),change:b}),this.add(this._startDateFilter),this._endDateFilter=new d.DateFilter({TextBefore:"To",ParameterName:"EndDate",initialValue:this._findInitialEndDate(),change:b}),this.add(this._endDateFilter)},e.prototype._findInitialEndDate=function(){var b=a.Utility.getQstringParam("EndDate"),c=new Date;return a.Utility.isUndefined(this._options.endDate)?a.Utility.isUndefined(b)?c:b:this._options.endDate},e.prototype._findInitialStartDate=function(){var b=a.Utility.getQstringParam("StartDate"),c=(new Date).getFullYear(),d=new Date(c,0,1);return a.Utility.isUndefined(this._options.startDate)?a.Utility.isUndefined(b)?d:b:this._options.startDate},e.prototype._renderGlobalFilters=function(a){for(var c=this._requestMediator,d=function(){c.globalChanged()},e=0;e<this._filters.length;e++)this._filters[e].render(a),b(this._filters[e]).on("filter",d)},c.GlobalFilterPanel=e}(window.Soris,jQuery),function(a,b){var c=a.namespace("Widgets"),d=a.Class.extend(function(b){this.options=a.Utility.loadDefaults({queryOnLoad:!1,globalQueryUrl:"/GlobalQuery"},b),this._registerLoadHandler()});d.resolve=function(){return a.Utility.isUndefined(d._config)&&(d._config=new c.EmptyPageConfiguration),d._config},d.create=function(a){return d._config=new d(a),d._config},d.prototype.resolveRequestMedia=function(){switch(this.options.requestMedia.type){case"ajax":return new c.AjaxWidgetRequestMedia(this.options.requestMedia);default:throw new Error("Unknown request media type")}},d.prototype._registerLoadHandler=function(){var a=this.options;b(window).load(function(){a.queryOnLoad&&setTimeout(function(){c.WidgetRequestMediator.getUnmanagedMediator().globalChanged()},250)})},c.PageConfiguration=d}(window.Soris,jQuery),function(a){var b=a.namespace("Widgets"),c=b.PageConfiguration.extend(function(){this.options={queryOnLoad:!1}});c.DEFAULT_QUERY_URL="/query",c.prototype.resolveRequestMedia=function(){return new b.AjaxWidgetRequestMedia({url:c.DEFAULT_QUERY_URL})},b.EmptyPageConfiguration=c}(window.Soris),function(a,b){"use strict";a.fn.sorisDirectionChangeWidget=function(b){var c=a.extend({WidgetID:"Missing DirectionChangeWidget ID",Title:"Untitled Widget",Filters:[]},b);this.each(function(){var a=new Soris.Widgets.DirectionChangeWidget(c);a.Render(this)})},a.fn.sorisChartWidget=function(b){var c=a.extend({WidgetID:"Missing ChartWidget ID",Title:"Untitled Widget",Filters:[]},b);this.each(function(){var a=new Soris.Widgets.ChartWidget(c);a.Render(this)})},a.fn.sorisGlobalFilterPanel=function(b){var c=a.extend({},b);this.each(function(){var a=new Soris.Widgets.GlobalFilterPanel(c);a.render(this)})}}(jQuery);
//# sourceMappingURL=Soris.all.min.js.map